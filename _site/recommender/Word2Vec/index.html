<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="generator" content="Jekyll v3.4.3">

		<link rel="stylesheet" href="/css/screen.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">
		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400italic,400,300italic,300,700,700italic|Open+Sans:400italic,600italic,700italic,700,600,400|Inconsolata:400,700">
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

		<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>From Word2Vec to Item Recommendation - Base</title>
<meta property="og:title" content="From Word2Vec to Item Recommendation" />
<meta name="description" content="Recommendation System Powered by Word2Vec" />
<meta property="og:description" content="Recommendation System Powered by Word2Vec" />
<link rel="canonical" href="https://orange-ape.cloudvent.net//recommender/Word2Vec/" />
<meta property="og:url" content="https://orange-ape.cloudvent.net//recommender/Word2Vec/" />
<meta property="og:site_name" content="Base" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-22T00:00:00+08:00" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "From Word2Vec to Item Recommendation",
"datePublished": "2018-01-22T00:00:00+08:00",
"description": "Recommendation System Powered by Word2Vec",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "https://orange-ape.cloudvent.net//siteicon.png"}},
"url": "https://orange-ape.cloudvent.net//recommender/Word2Vec/"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="https://orange-ape.cloudvent.net//feed.xml" title="Base" />

		
	</head>

	<body class="">
		<header>
			<div class="wrapper">
				<section class="top-bar">
					<a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
<nav>
	<a class="editor-link btn" href="cloudcannon:collections/_data/navigation.yml" class="btn" style="padding: 5px;"><strong>&#9998;</strong> Edit navigation</a>
	
	

		
		<a href="/" class="">Tutorials</a>
	
	

		
		<a href="/videos/" class="">Videos</a>
	
	

		
		<a href="/faq/" class="">FAQ</a>
	
</nav>

				</section>
				<section class="hero_search">
					<h1>Tutorials</h1>
					<p>Everything you need to know about running our software.</p>
					<form action="/search/" method="get">
	<input type="search" name="q"  placeholder="What would you like to know?" autofocus>
	<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
	<input type="submit" value="Search" style="display: none;">
</form>
				</section>
			</div>

		</header>
		<section class="content">
			<div class="wrapper">
				<section class="tutorial">
	<section class="sidebar sticky">
		<ul>
			
			
		</ul>
	</section>
	<section class="tutorial-content">
		<h1>From Word2Vec to Item Recommendation</h1>

		
		
		<div class="tutorial-main">
			<p>As a data analyst, I’m always looking for ways to leverage massive data set to automate customer-facing experiences.</p>

<p>Following is a minimalist script explaining how to apply Word2Vec for item recommendation and the data science behind it.</p>

<p>The demo data can be downloaded here: https://github.com/zygmuntz/goodbooks-10k</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">gettempdir</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="n">urllib</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">xrange</span>  <span class="c"># pylint: disable=redefined-builtin</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">tr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="s">'to_read.csv'</span> <span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="s">'books.csv'</span> <span class="p">)</span>
<span class="n">bt</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">b</span><span class="p">[[</span> <span class="s">'book_id'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">]],</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'book_id'</span> <span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">bt</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>

<p>Make every user’s to-read list as a sentence and feed it into word2vec.</p>

<p>Given a dataset large enough, it can find out similar books</p>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>book_id</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>493151</th>
      <td>12921</td>
      <td>98</td>
      <td>The Girl Who Played with Fire (Millennium, #2)</td>
    </tr>
    <tr>
      <th>458637</th>
      <td>33014</td>
      <td>51</td>
      <td>City of Bones (The Mortal Instruments, #1)</td>
    </tr>
    <tr>
      <th>594218</th>
      <td>10492</td>
      <td>2476</td>
      <td>The Winter Sea (Slains, #1)</td>
    </tr>
    <tr>
      <th>84267</th>
      <td>11410</td>
      <td>341</td>
      <td>The Iliad</td>
    </tr>
    <tr>
      <th>35157</th>
      <td>17107</td>
      <td>13</td>
      <td>1984</td>
    </tr>
    <tr>
      <th>712362</th>
      <td>38510</td>
      <td>3852</td>
      <td>Deity (Covenant, #3)</td>
    </tr>
    <tr>
      <th>467464</th>
      <td>48549</td>
      <td>17</td>
      <td>Catching Fire (The Hunger Games, #2)</td>
    </tr>
    <tr>
      <th>519192</th>
      <td>48347</td>
      <td>182</td>
      <td>Beautiful Creatures (Caster Chronicles, #1)</td>
    </tr>
    <tr>
      <th>366676</th>
      <td>22024</td>
      <td>188</td>
      <td>A Dance with Dragons (A Song of Ice and Fire, #5)</td>
    </tr>
    <tr>
      <th>588764</th>
      <td>31407</td>
      <td>3953</td>
      <td>The New Jim Crow: Mass Incarceration in the Ag...</td>
    </tr>
  </tbody>
</table>
</div>

<p>Detailed exploration and data cleaning process -&gt;</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">raw</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'user_id'</span><span class="p">)[</span><span class="s">'title'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">==</span><span class="n">tr</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">books</span> <span class="ow">in</span> <span class="n">raw</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">books</span><span class="p">]</span>
<span class="n">n_words</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"There are {} books and {} to-read records"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_words</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>There are 9951 books and 912705 to-read records
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">build_dataset</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">n_words</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">Counter</span><span class="p">(</span><span class="n">words</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="n">n_words</span><span class="p">))</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">count</span><span class="p">:</span>
        <span class="n">dictionary</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="n">reversed_dictionary</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">reversed_dictionary</span>


</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">data</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">reverse_dictionary</span> <span class="o">=</span> <span class="n">build_dataset</span><span class="p">(</span><span class="n">words</span><span class="p">,</span><span class="n">n_words</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>"The Aviator's Wife"
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.python.client</span> <span class="kn">import</span> <span class="n">device_lib</span>
<span class="n">device_lib</span><span class="o">.</span><span class="n">list_local_devices</span><span class="p">()</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>[name: "/cpu:0"
 device_type: "CPU"
 memory_limit: 268435456
 locality {
 }
 incarnation: 15191507020555158226]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c"># Step 3: Function to generate a training batch for the skip-gram model.</span>
<span class="k">def</span> <span class="nf">generate_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">num_skips</span><span class="p">,</span> <span class="n">skip_window</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">data_index</span>
    <span class="k">assert</span> <span class="n">batch_size</span> <span class="o">%</span> <span class="n">num_skips</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="n">num_skips</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="n">skip_window</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">span</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">skip_window</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c"># [ skip_window target skip_window ]</span>
    <span class="nb">buffer</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">span</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_index</span> <span class="o">+</span> <span class="n">span</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">data_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data_index</span><span class="p">:</span><span class="n">data_index</span> <span class="o">+</span> <span class="n">span</span><span class="p">])</span>
    <span class="n">data_index</span> <span class="o">+=</span> <span class="n">span</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">//</span> <span class="n">num_skips</span><span class="p">):</span>
        <span class="n">context_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">span</span><span class="p">)</span> <span class="k">if</span> <span class="n">w</span> <span class="o">!=</span> <span class="n">skip_window</span><span class="p">]</span>
        <span class="n">words_to_use</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">context_words</span><span class="p">,</span> <span class="n">num_skips</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">context_word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">words_to_use</span><span class="p">):</span>
            <span class="n">batch</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">num_skips</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">buffer</span><span class="p">[</span><span class="n">skip_window</span><span class="p">]</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">num_skips</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">buffer</span><span class="p">[</span><span class="n">context_word</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:</span><span class="n">span</span><span class="p">]:</span>
                <span class="nb">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>
            <span class="n">data_index</span> <span class="o">=</span> <span class="n">span</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data_index</span><span class="p">])</span>
            <span class="n">data_index</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="c"># Backtrack a little bit to avoid skipping words in the end of a batch</span>
    <span class="n">data_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_index</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">span</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">batch</span><span class="p">,</span> <span class="n">labels</span>

<span class="n">batch</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">generate_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">num_skips</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">skip_window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
  <span class="k">print</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">reverse_dictionary</span><span class="p">[</span><span class="n">batch</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
        <span class="s">'-&gt;'</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">reverse_dictionary</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>86 Me Before You (Me Before You, #1) -&gt; 380 The Husband's Secret
86 Me Before You (Me Before You, #1) -&gt; 721 The Aviator's Wife
380 The Husband's Secret -&gt; 175 A Little Life
380 The Husband's Secret -&gt; 86 Me Before You (Me Before You, #1)
175 A Little Life -&gt; 51 Go Set a Watchman
175 A Little Life -&gt; 380 The Husband's Secret
51 Go Set a Watchman -&gt; 175 A Little Life
51 Go Set a Watchman -&gt; 1094 The Marriage of Opposites
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Step 4: Build and train a skip-gram model.</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">embedding_size</span> <span class="o">=</span> <span class="mi">128</span>  <span class="c"># Dimension of the embedding vector.</span>
<span class="n">skip_window</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c"># How many words to consider left and right.</span>
<span class="n">num_skips</span> <span class="o">=</span> <span class="mi">2</span>         <span class="c"># How many times to reuse an input to generate a label.</span>
<span class="n">num_sampled</span> <span class="o">=</span> <span class="mi">64</span>      <span class="c"># Number of negative examples to sample.</span>

<span class="c"># We pick a random validation set to sample nearest neighbors. Here we limit the</span>
<span class="c"># validation samples to the words that have a low numeric ID, which by</span>
<span class="c"># construction are also the most frequent. These 3 variables are used only for</span>
<span class="c"># displaying model accuracy, they don't affect calculation.</span>
<span class="n">valid_size</span> <span class="o">=</span> <span class="mi">16</span>     <span class="c"># Random set of words to evaluate similarity on.</span>
<span class="n">valid_window</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c"># Only pick dev samples in the head of the distribution.</span>
<span class="n">valid_examples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">valid_window</span><span class="p">,</span> <span class="n">valid_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


<span class="n">graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>

  <span class="c"># Input data.</span>
    <span class="n">train_inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="n">batch_size</span><span class="p">])</span>
    <span class="n">train_labels</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">valid_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">valid_examples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

  <span class="c"># Ops and variables pinned to the CPU because of missing GPU implementation</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s">'/cpu:0'</span><span class="p">):</span>
        <span class="n">embeddings</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">random_uniform</span><span class="p">([</span><span class="n">n_words</span><span class="p">,</span><span class="n">embedding_size</span><span class="p">],</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">))</span>
        <span class="n">embed</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">embedding_lookup</span><span class="p">(</span><span class="n">embeddings</span><span class="p">,</span> <span class="n">train_inputs</span><span class="p">)</span>

        <span class="c"># Construct the variables for the NCE loss</span>
        <span class="n">nce_weights</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
            <span class="n">tf</span><span class="o">.</span><span class="n">truncated_normal</span><span class="p">([</span><span class="n">n_words</span><span class="p">,</span> <span class="n">embedding_size</span><span class="p">],</span>
                                <span class="n">stddev</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">embedding_size</span><span class="p">)))</span>
        <span class="n">nce_biases</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_words</span><span class="p">]))</span>

    <span class="c"># Compute the average NCE loss for the batch.</span>
    <span class="c"># tf.nce_loss automatically draws a new sample of the negative labels each</span>
    <span class="c"># time we evaluate the loss.</span>
    <span class="c"># Explanation of the meaning of NCE loss:</span>
    <span class="c">#   http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span>
      <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">nce_loss</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">nce_weights</span><span class="p">,</span>
                     <span class="n">biases</span><span class="o">=</span><span class="n">nce_biases</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">train_labels</span><span class="p">,</span>
                     <span class="n">inputs</span><span class="o">=</span><span class="n">embed</span><span class="p">,</span>
                     <span class="n">num_sampled</span><span class="o">=</span><span class="n">num_sampled</span><span class="p">,</span>
                     <span class="n">num_classes</span><span class="o">=</span><span class="n">n_words</span><span class="p">))</span>

    <span class="c"># Construct the SGD optimizer using a learning rate of 1.0.</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>

    <span class="c"># Compute the cosine similarity between minibatch examples and all embeddings.</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">embeddings</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">keep_dims</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">normalized_embeddings</span> <span class="o">=</span> <span class="n">embeddings</span> <span class="o">/</span> <span class="n">norm</span>
    <span class="n">valid_embeddings</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">embedding_lookup</span><span class="p">(</span>
      <span class="n">normalized_embeddings</span><span class="p">,</span> <span class="n">valid_dataset</span><span class="p">)</span>
    <span class="n">similarity</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
      <span class="n">valid_embeddings</span><span class="p">,</span> <span class="n">normalized_embeddings</span><span class="p">,</span> <span class="n">transpose_b</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c"># Add variable initializer.</span>
    <span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

<span class="c"># Step 5: Begin training.</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="mi">100001</span>

<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>
    <span class="c"># We must initialize all variables before we use them.</span>
    <span class="n">init</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Initialized'</span><span class="p">)</span>

    <span class="n">average_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">batch_inputs</span><span class="p">,</span> <span class="n">batch_labels</span> <span class="o">=</span> <span class="n">generate_batch</span><span class="p">(</span>
            <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_skips</span><span class="p">,</span> <span class="n">skip_window</span><span class="p">)</span>
        <span class="n">feed_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">train_inputs</span><span class="p">:</span> <span class="n">batch_inputs</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">:</span> <span class="n">batch_labels</span><span class="p">}</span>

        <span class="c"># We perform one update step by evaluating the optimizer op (including it</span>
        <span class="c"># in the list of returned values for session.run()</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">loss_val</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="p">],</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">feed_dict</span><span class="p">)</span>
        <span class="n">average_loss</span> <span class="o">+=</span> <span class="n">loss_val</span>

        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">average_loss</span> <span class="o">/=</span> <span class="mi">2000</span>
          <span class="c"># The average loss is an estimate of the loss over the last 2000 batches.</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'Average loss at step '</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="s">': '</span><span class="p">,</span> <span class="n">average_loss</span><span class="p">)</span>
            <span class="n">average_loss</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c"># Note that this is expensive (~20% slowdown if computed every 500 steps)</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">10000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sim</span> <span class="o">=</span> <span class="n">similarity</span><span class="o">.</span><span class="nb">eval</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">valid_size</span><span class="p">):</span>
                <span class="n">valid_word</span> <span class="o">=</span> <span class="n">reverse_dictionary</span><span class="p">[</span><span class="n">valid_examples</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">top_k</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c"># number of nearest neighbors</span>
                <span class="n">nearest</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sim</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="n">top_k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">log_str</span> <span class="o">=</span> <span class="s">'Nearest to </span><span class="si">%</span><span class="s">s:'</span> <span class="o">%</span> <span class="n">valid_word</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">top_k</span><span class="p">):</span>
                    <span class="n">close_word</span> <span class="o">=</span> <span class="n">reverse_dictionary</span><span class="p">[</span><span class="n">nearest</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>
                    <span class="n">log_str</span> <span class="o">=</span> <span class="s">'</span><span class="si">%</span><span class="s">s </span><span class="si">%</span><span class="s">s,'</span> <span class="o">%</span> <span class="p">(</span><span class="n">log_str</span><span class="p">,</span> <span class="n">close_word</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">log_str</span><span class="p">)</span>
    <span class="n">final_embeddings</span> <span class="o">=</span> <span class="n">normalized_embeddings</span><span class="o">.</span><span class="nb">eval</span><span class="p">()</span>


</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Initialized
Average loss at step  0 :  240.497894287
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Gerald's Game, Rat Queens, Vol. 1: Sass &amp; Sorcery, An American Tragedy, Purple Cow: Transform Your Business by Being Remarkable, Humans of New York: Stories, Beyond the Grave (The 39 Clues #4), The Weight of Silence, Certain Prey (Lucas Davenport, #10),
Nearest to Lord of the Flies: The Age of Miracles, Ida B. . . and Her Plans to Maximize Fun, Avoid Disaster, and (Possibly) Save the World, The Source of Magic (Xanth, #2), Blackwood Farm (The Vampire Chronicles, #9), The Power of One (The Power of One, #1), Whispers at Moonrise (Shadow Falls, #4), Stitches, Holiday in Death (In Death, #7),
Nearest to Bossypants: First Love, The Expats, Girlfriend in a Coma, The Boyfriend List: 15 Guys, 11 Shrink Appointments, 4 Ceramic Frogs and Me, Ruby Oliver (Ruby Oliver, #1), Ordinary People, I Want My Hat Back, Walk Two Moons, Restless,
Nearest to City of Bones (The Mortal Instruments, #1): A Moveable Feast, Travesuras de la niña mala, Outcast of Redwall (Redwall, #8), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, Red Seas Under Red Skies (Gentleman Bastard, #2), Cat on a Hot Tin Roof, The Unexpected Mrs. Pollifax  (Mrs. Pollifax #1), Once (Eve, #2),
Nearest to Jane Eyre: A Court of Mist and Fury (A Court of Thorns and Roses, #2), And the Mountains Echoed, Ever After (The Hollows, #11), The Darkest Pleasure (Lords of the Underworld #3), The Beekeeper's Apprentice (Mary Russell, #1), The Evolution of Mara Dyer (Mara Dyer, #2), Ten Tiny Breaths (Ten Tiny Breaths, #1), Thinking, Fast and Slow,
Nearest to The Lovely Bones: No Country for Old Men, The House Girl, Krakatoa: The Day the World Exploded, Heir of Fire (Throne of Glass, #3), This Side of Paradise, Porno, The Watchman (Elvis Cole, #11; Joe Pike, #1), A Hunger Like No Other (Immortals After Dark #2),
Nearest to The Giver (The Giver, #1): George, Hourglass (Hourglass, #1), Raise High the Roof Beam, Carpenters &amp; Seymour: An Introduction, J is for Judgment (Kinsey Millhone, #10), Deeper Than the Dead (Oak Knoll, #1), Book of the Dead (Kay Scarpetta, #15), The Good, the Bad, and the Undead (The Hollows, #2), The Temple of My Familiar,
Nearest to Atonement: Thirst No. 3: The Eternal Dawn (Thirst, #3), Barefoot Contessa Family Style: Easy Ideas and Recipes That Make Everyone Feel Like Family, Five Point Someone, Dark Legend (Dark, #8), Lord Loss (The Demonata, #1), The Pioneer Woman Cooks: Recipes from an Accidental Country Girl, Revelation (Matthew Shardlake, #4), Fairest (An Unfortunate Fairy Tale, #2),
Nearest to The Handmaid's Tale: The Tell-Tale Heart and Other Writings, Sloppy Firsts (Jessica Darling, #1), Clifford the Big Red Dog, Think Twice (Rosato &amp; Associates, #11), Hardwired (Hacker, #1), Homage to Catalonia, Jazz, L is for Lawless (Kinsey Millhone, #12),
Nearest to Animal Farm: Haunted, The Golem and the Jinni (The Golem and the Jinni, #1), Flat Stanley (Flat Stanley, #1), Gap Creek, Crazy For You, Rise of Empire (The Riyria Revelations, #3-4), Radiant Shadows (Wicked Lovely, #4), Killing Yourself to Live: 85% of a True Story,
Nearest to The Ocean at the End of the Lane: The Warrior Heir (The Heir Chronicles, #1), Killing Yourself to Live: 85% of a True Story, The Complete Novels, A Breath of Snow and Ashes (Outlander, #6), The Last Coyote (Harry Bosch, #4; Harry Bosch Universe, #4), Owl Moon, All the Birds in the Sky, Self-Reliance and Other Essays,
Nearest to Outlander (Outlander, #1): A God in Ruins, Mariana, Father Mine (Black Dagger Brotherhood, #6.5), The Apostle (Scot Harvath, #8), Voyager (Outlander, #3), The Rosie Effect (Don Tillman, #2), Rodrick Rules (Diary of a Wimpy Kid, #2), The Book of Joe,
Nearest to The Poisonwood Bible: Percy Jackson and the Sword of Hades (Percy Jackson and the Olympians, #4.5), Open Season, The Orphan Master's Son, Shōgun (Asian Saga, #1), Harold and the Purple Crayon, The Solitude of Prime Numbers, A Thousand Pieces of You (Firebird, #1), Heir of Fire (Throne of Glass, #3),
Nearest to 1984: The Mad Ship (Liveship Traders, #2), Rosencrantz and Guildenstern Are Dead, The Monk, Magic Steps (The Circle Opens, #1), The Science of Getting Rich, The Fountains of Paradise, The Red Knight (The Traitor Son Cycle, #1), The God Delusion,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: Songs of Innocence and of Experience, Little House in the Big Woods (Little House, #1), The Calling (Darkness Rising, #2), Complete Poems, 1904-1962, Gorky Park (Arkady Renko, #1), Burn for Burn (Burn for Burn, #1), Death in Venice, The Phantom Tollbooth,
Nearest to The Maze Runner (Maze Runner, #1): Trojan Odyssey (Dirk Pitt, #17), Love, Stargirl (Stargirl, #2), Assholes Finish First (Tucker Max, #2), The 39 Steps (Richard Hannay, #1), Moriarty (Sherlock Holmes #2), Neil Patrick Harris: Choose Your Own Autobiography, Vampire Knight, Vol. 4 (Vampire Knight, #4), The Path to Power (The Years of Lyndon Johnson, #1),
Average loss at step  2000 :  51.1207590363
Average loss at step  4000 :  8.39590741718
Average loss at step  6000 :  5.54902770615
Average loss at step  8000 :  4.92703645575
Average loss at step  10000 :  4.68519584727
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Purple Cow: Transform Your Business by Being Remarkable, Gerald's Game, Rat Queens, Vol. 1: Sass &amp; Sorcery, The Weight of Silence, The Highlander's Touch (Highlander, #3), Lucky Jim, Humans of New York: Stories, Rise of the Elgen (Michael Vey, #2),
Nearest to Lord of the Flies: Crime and Punishment, Zen and the Art of Motorcycle Maintenance: An Inquiry Into Values, The Great Gatsby, The Source of Magic (Xanth, #2), The Power of One (The Power of One, #1), The Shining (The Shining #1), Blackwood Farm (The Vampire Chronicles, #9), What We Keep ,
Nearest to Bossypants: The Expats, Kabul Beauty School: An American Woman Goes Behind the Veil, A Trick of the Light (Chief Inspector Armand Gamache, #7), Walk Two Moons, Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), Chanakya's Chant, Glue, Everbound (Everneath, #2),
Nearest to City of Bones (The Mortal Instruments, #1): Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, The Forgotten Garden, Clockwork Angel (The Infernal Devices, #1), One Day, Kitty and the Midnight Hour (Kitty Norville #1), Such a Rush, Once (Eve, #2), The Righteous Mind: Why Good People are Divided by Politics and Religion,
Nearest to Jane Eyre: The Subtle Knife (His Dark Materials, #2), Extremely Loud and Incredibly Close, The Lovely Bones, Eat, Pray, Love, Islands in the Stream, The Beekeeper's Apprentice (Mary Russell, #1), A Long Way Gone: Memoirs of a Boy Soldier, A Court of Mist and Fury (A Court of Thorns and Roses, #2),
Nearest to The Lovely Bones: No Country for Old Men, The Secret Life of Bees, The House Girl, Two Ravens and One Crow (The Iron Druid Chronicles, #4.5), Krakatoa: The Day the World Exploded, This Side of Paradise, Jane Eyre, Uglies (Uglies, #1),
Nearest to The Giver (The Giver, #1): Animal, Vegetable, Miracle: A Year of Food Life, Life of Pi, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), The Old Man and the Sea, George, The Good, the Bad, and the Undead (The Hollows, #2), Till We Have Faces, J is for Judgment (Kinsey Millhone, #10),
Nearest to Atonement: Siddhartha, Lord Loss (The Demonata, #1), The Old Man and the Sea, Story of the Eye, To Kill a Mockingbird, Priestess of the White (Age of the Five, #1), A Deepness in the Sky (Zones of Thought, #2), Complete Works of Oscar Wilde,
Nearest to The Handmaid's Tale: The Tell-Tale Heart and Other Writings, Three Cups of Tea: One Man's Mission to Promote Peace ... One School at a Time, For Whom the Bell Tolls, Girl, Stolen (Girl, Stolen #1), Dragon Ball, Vol. 1: The Monkey King (Dragon Ball, #1), Providence (Providence, #1), The Mists of Avalon (Avalon, #1), Hardwired (Hacker, #1),
Nearest to Animal Farm: Haunted, Gap Creek, Flat Stanley (Flat Stanley, #1), Killing Yourself to Live: 85% of a True Story, Blood Magick (The Cousins O'Dwyer Trilogy, #3), Radiant Shadows (Wicked Lovely, #4), Crash &amp; Burn (Tessa Leoni, #3), Angels &amp; Demons  (Robert Langdon, #1),
Nearest to The Ocean at the End of the Lane: The Complete Novels, A Breath of Snow and Ashes (Outlander, #6), Owl Moon, Ms. Marvel, Vol. 2: Generation Why, One More Chance (Rosemary Beach, #8; Chance, #2), The Warrior Heir (The Heir Chronicles, #1), Rogues, Unlimited Power : The New Science Of Personal Achievement,
Nearest to Outlander (Outlander, #1): Leven Thumps and the Eyes of the Want (Leven Thumps, #3), Ender's Game (Ender's Saga, #1), The Mermaid Chair, A God in Ruins, When Calls the Heart (Canadian West, #1), The Rosie Effect (Don Tillman, #2), Father Mine (Black Dagger Brotherhood, #6.5), Redshirts,
Nearest to The Poisonwood Bible: Percy Jackson and the Sword of Hades (Percy Jackson and the Olympians, #4.5), Harold and the Purple Crayon, Open Season, The First World War, Mere Christianity, The Solitude of Prime Numbers, The Plot Against America, A Thousand Pieces of You (Firebird, #1),
Nearest to 1984: Rosencrantz and Guildenstern Are Dead, The God Delusion, The Red Knight (The Traitor Son Cycle, #1), Slaughterhouse-Five, The Science of Getting Rich, The Monk, Magic Steps (The Circle Opens, #1), Gone (Wake, #3),
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: Complete Poems, 1904-1962, The Hobbit, The Joke, Slaughterhouse-Five, Songs of Innocence and of Experience, The Panther  (John Corey, #6), Little House in the Big Woods (Little House, #1), Gorky Park (Arkady Renko, #1),
Nearest to The Maze Runner (Maze Runner, #1): Trojan Odyssey (Dirk Pitt, #17), The 39 Steps (Richard Hannay, #1), Moriarty (Sherlock Holmes #2), Assholes Finish First (Tucker Max, #2), Neil Patrick Harris: Choose Your Own Autobiography, The Body Finder (The Body Finder, #1), Love, Stargirl (Stargirl, #2), Brotherhood in Death (In Death, #42),
Average loss at step  12000 :  4.50244684148
Average loss at step  14000 :  4.33098444271
Average loss at step  16000 :  4.28433195019
Average loss at step  18000 :  4.09698849154
Average loss at step  20000 :  4.04729236376
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Purple Cow: Transform Your Business by Being Remarkable, Rat Queens, Vol. 1: Sass &amp; Sorcery, Gerald's Game, The Highlander's Touch (Highlander, #3), Rise of the Elgen (Michael Vey, #2), Beautiful Bitch (Beautiful Bastard, #1.5), Treasure Island, The Weight of Silence,
Nearest to Lord of the Flies: Crime and Punishment, Zen and the Art of Motorcycle Maintenance: An Inquiry Into Values, The Great Gatsby, The Shining (The Shining #1), The Source of Magic (Xanth, #2), 1984, The Quiet American, Ulysses,
Nearest to Bossypants: Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), The Expats, State of Wonder, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, Rapture (Fallen, #4), A Trick of the Light (Chief Inspector Armand Gamache, #7), Chanakya's Chant, National Velvet,
Nearest to City of Bones (The Mortal Instruments, #1): One Day, Clockwork Angel (The Infernal Devices, #1), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, The Help, Chains (Seeds of America, #1), The Forgotten Garden, Graceling (Graceling Realm, #1), Kitty and the Midnight Hour (Kitty Norville #1),
Nearest to Jane Eyre: The Subtle Knife (His Dark Materials, #2), The Lovely Bones, Extremely Loud and Incredibly Close, Eat, Pray, Love, Les Misérables, A Long Way Gone: Memoirs of a Boy Soldier, Memoirs of a Geisha, The Beekeeper's Apprentice (Mary Russell, #1),
Nearest to The Lovely Bones: The Secret Life of Bees, No Country for Old Men, Two Ravens and One Crow (The Iron Druid Chronicles, #4.5), Jane Eyre, Uglies (Uglies, #1), The House Girl, This Side of Paradise, Divided in Death (In Death, #18),
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Life of Pi, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), Animal, Vegetable, Miracle: A Year of Food Life, Memoirs of a Geisha, Team of Rivals: The Political Genius of Abraham Lincoln, George, Till We Have Faces,
Nearest to Atonement: Siddhartha, The Old Man and the Sea, Lord Loss (The Demonata, #1), To Kill a Mockingbird, Memoirs of a Geisha, Story of the Eye, Breakfast of Champions, Choke,
Nearest to The Handmaid's Tale: Three Cups of Tea: One Man's Mission to Promote Peace ... One School at a Time, For Whom the Bell Tolls, The Mists of Avalon (Avalon, #1), The Portrait of a Lady, White Noise, No Country for Old Men, Wintersmith (Discworld, #35; Tiffany Aching, #3), Running with Scissors,
Nearest to Animal Farm: Haunted, Gone with the Wind, Artemis Fowl (Artemis Fowl, #1), Killing Yourself to Live: 85% of a True Story, Gap Creek, Angels &amp; Demons  (Robert Langdon, #1), Flat Stanley (Flat Stanley, #1), Black Hole,
Nearest to The Ocean at the End of the Lane: The Complete Novels, Owl Moon, Unlimited Power : The New Science Of Personal Achievement, Ms. Marvel, Vol. 2: Generation Why, Z: A Novel of Zelda Fitzgerald, The Runaway King (The Ascendance Trilogy, #2), Rogues, One More Chance (Rosemary Beach, #8; Chance, #2),
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Leven Thumps and the Eyes of the Want (Leven Thumps, #3), A God in Ruins, Ender's Game (Ender's Saga, #1), Redshirts, When Calls the Heart (Canadian West, #1), The Golden Compass (His Dark Materials, #1), Father Mine (Black Dagger Brotherhood, #6.5),
Nearest to The Poisonwood Bible: The Plot Against America, The Kite Runner, Mere Christianity, Harold and the Purple Crayon, Percy Jackson and the Sword of Hades (Percy Jackson and the Olympians, #4.5), Open Season, The First World War, Anil's Ghost,
Nearest to 1984: The God Delusion, Rosencrantz and Guildenstern Are Dead, Slaughterhouse-Five, Lolita, Guns, Germs, and Steel: The Fates of Human Societies, The Red Knight (The Traitor Son Cycle, #1), The Time Traveler's Wife, Magic Steps (The Circle Opens, #1),
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: Slaughterhouse-Five, The Joke, Salt: A World History, The Hobbit, Interpreter of Maladies, The Panther  (John Corey, #6), The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), Complete Poems, 1904-1962,
Nearest to The Maze Runner (Maze Runner, #1): Trojan Odyssey (Dirk Pitt, #17), The 39 Steps (Richard Hannay, #1), The Body Finder (The Body Finder, #1), Moriarty (Sherlock Holmes #2), Apathy and Other Small Victories, Assholes Finish First (Tucker Max, #2), Brotherhood in Death (In Death, #42), The Soldier's Wife,
Average loss at step  22000 :  3.99871511078
Average loss at step  24000 :  3.91173057818
Average loss at step  26000 :  3.85994793272
Average loss at step  28000 :  3.77732089114
Average loss at step  30000 :  3.83034379864
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Purple Cow: Transform Your Business by Being Remarkable, Rat Queens, Vol. 1: Sass &amp; Sorcery, Midnight Sun (Twilight, #1.5), The Highlander's Touch (Highlander, #3), Gerald's Game, The Prince of Tides, The Sirens of Titan, Treasure Island,
Nearest to Lord of the Flies: Crime and Punishment, Zen and the Art of Motorcycle Maintenance: An Inquiry Into Values, The Great Gatsby, The Quiet American, 1984, The Shining (The Shining #1), The Source of Magic (Xanth, #2), The Holy Bible: English Standard Version,
Nearest to Bossypants: Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), The Expats, State of Wonder, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, Rapture (Fallen, #4), Barbarians at the Gate: The Fall of RJR Nabisco, A Trick of the Light (Chief Inspector Armand Gamache, #7), Chanakya's Chant,
Nearest to City of Bones (The Mortal Instruments, #1): One Day, The Help, Chains (Seeds of America, #1), Clockwork Angel (The Infernal Devices, #1), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, Graceling (Graceling Realm, #1), Best Friends Forever, City of Glass (The Mortal Instruments, #3),
Nearest to Jane Eyre: The Subtle Knife (His Dark Materials, #2), The Lovely Bones, Eat, Pray, Love, Les Misérables, Memoirs of a Geisha, Extremely Loud and Incredibly Close, Beloved, A Long Way Gone: Memoirs of a Boy Soldier,
Nearest to The Lovely Bones: The Secret Life of Bees, No Country for Old Men, Jane Eyre, Uglies (Uglies, #1), Two Ravens and One Crow (The Iron Druid Chronicles, #4.5), The Bookseller of Kabul, The House Girl, The Diary of a Young Girl,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Life of Pi, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), Animal, Vegetable, Miracle: A Year of Food Life, Memoirs of a Geisha, Till We Have Faces, Beloved, Prodigal Summer,
Nearest to Atonement: Siddhartha, The Old Man and the Sea, To Kill a Mockingbird, Lord Loss (The Demonata, #1), Memoirs of a Geisha, Breakfast of Champions, Story of the Eye, Choke,
Nearest to The Handmaid's Tale: Three Cups of Tea: One Man's Mission to Promote Peace ... One School at a Time, For Whom the Bell Tolls, White Noise, The Portrait of a Lady, The Mists of Avalon (Avalon, #1), No Country for Old Men, Dry, Running with Scissors,
Nearest to Animal Farm: Haunted, Gone with the Wind, Killing Yourself to Live: 85% of a True Story, Artemis Fowl (Artemis Fowl, #1), Ishmael:A Novel, The Crucible, A Farewell to Arms, Black Hole,
Nearest to The Ocean at the End of the Lane: Owl Moon, Brain on Fire: My Month of Madness, The Complete Novels, Z: A Novel of Zelda Fitzgerald, The Runaway King (The Ascendance Trilogy, #2), Ms. Marvel, Vol. 2: Generation Why, Unlimited Power : The New Science Of Personal Achievement, One More Chance (Rosemary Beach, #8; Chance, #2),
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Ender's Game (Ender's Saga, #1), Leven Thumps and the Eyes of the Want (Leven Thumps, #3), A God in Ruins, The Golden Compass (His Dark Materials, #1), When Calls the Heart (Canadian West, #1), Redshirts, A Thousand Splendid Suns,
Nearest to The Poisonwood Bible: The Plot Against America, The Kite Runner, Mere Christianity, The Color Purple, Cloud Atlas, Anil's Ghost, Harold and the Purple Crayon, Guns, Germs, and Steel: The Fates of Human Societies,
Nearest to 1984: The God Delusion, Slaughterhouse-Five, Rosencrantz and Guildenstern Are Dead, The Time Traveler's Wife, Lord of the Flies, Lolita, Ender's Game (Ender's Saga, #1), The Red Knight (The Traitor Son Cycle, #1),
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: Slaughterhouse-Five, The Joke, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), Salt: A World History, Interpreter of Maladies, The Hobbit, The Panther  (John Corey, #6), The Man Who Mistook His Wife for a Hat and Other Clinical Tales,
Nearest to The Maze Runner (Maze Runner, #1): The Body Finder (The Body Finder, #1), The 39 Steps (Richard Hannay, #1), Trojan Odyssey (Dirk Pitt, #17), Soulless (Parasol Protectorate, #1), Apathy and Other Small Victories, Beautiful Darkness (Caster Chronicles, #2), Beautiful Creatures (Caster Chronicles, #1), Boneshaker (The Clockwork Century, #1),
Average loss at step  32000 :  3.72505885243
Average loss at step  34000 :  3.67791794622
Average loss at step  36000 :  3.65302069092
Average loss at step  38000 :  3.60529408705
Average loss at step  40000 :  3.57170747757
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Midnight Sun (Twilight, #1.5), Purple Cow: Transform Your Business by Being Remarkable, The Sirens of Titan, The Graveyard Book, The Mote in God's Eye, The Prince of Tides, James and the Giant Peach, Outliers: The Story of Success,
Nearest to Lord of the Flies: Crime and Punishment, The Great Gatsby, Zen and the Art of Motorcycle Maintenance: An Inquiry Into Values, 1984, The Quiet American, The Shining (The Shining #1), The Source of Magic (Xanth, #2), Ulysses,
Nearest to Bossypants: Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), State of Wonder, The Expats, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, Barbarians at the Gate: The Fall of RJR Nabisco, Rapture (Fallen, #4), A Trick of the Light (Chief Inspector Armand Gamache, #7), Chanakya's Chant,
Nearest to City of Bones (The Mortal Instruments, #1): One Day, Chains (Seeds of America, #1), The Help, Graceling (Graceling Realm, #1), Clockwork Angel (The Infernal Devices, #1), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, City of Glass (The Mortal Instruments, #3), Best Friends Forever,
Nearest to Jane Eyre: The Lovely Bones, Eat, Pray, Love, Memoirs of a Geisha, The Subtle Knife (His Dark Materials, #2), Les Misérables, Beloved, The Importance of Being Earnest, A Long Way Gone: Memoirs of a Boy Soldier,
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, No Country for Old Men, Uglies (Uglies, #1), The Diary of a Young Girl, The Bookseller of Kabul, Middlesex, The Memory Keeper's Daughter,
Nearest to The Giver (The Giver, #1): Life of Pi, The Old Man and the Sea, Memoirs of a Geisha, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), Animal, Vegetable, Miracle: A Year of Food Life, Till We Have Faces, Catch-22, The Children of Húrin,
Nearest to Atonement: Siddhartha, The Old Man and the Sea, To Kill a Mockingbird, Breakfast of Champions, Lord Loss (The Demonata, #1), Memoirs of a Geisha, Choke, Beloved,
Nearest to The Handmaid's Tale: The Mists of Avalon (Avalon, #1), White Noise, The Portrait of a Lady, For Whom the Bell Tolls, Three Cups of Tea: One Man's Mission to Promote Peace ... One School at a Time, No Country for Old Men, Dry, The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus,
Nearest to Animal Farm: Haunted, Gone with the Wind, Artemis Fowl (Artemis Fowl, #1), Ishmael:A Novel, The Crucible, Killing Yourself to Live: 85% of a True Story, Black Hole, A Farewell to Arms,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), Owl Moon, Brain on Fire: My Month of Madness, Lone Wolf, The Twelve Tribes of Hattie, The Ship of Brides, Anya's Ghost, One More Chance (Rosemary Beach, #8; Chance, #2),
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Ender's Game (Ender's Saga, #1), Leven Thumps and the Eyes of the Want (Leven Thumps, #3), Life of Pi, A God in Ruins, The Golden Compass (His Dark Materials, #1), When Calls the Heart (Canadian West, #1), Cloud Atlas,
Nearest to The Poisonwood Bible: The Kite Runner, The Plot Against America, Cloud Atlas, The Color Purple, Mere Christianity, Anil's Ghost, Jitterbug Perfume, Guns, Germs, and Steel: The Fates of Human Societies,
Nearest to 1984: The God Delusion, Slaughterhouse-Five, Rosencrantz and Guildenstern Are Dead, The Time Traveler's Wife, Lolita, Lord of the Flies, Ender's Game (Ender's Saga, #1), Crime and Punishment,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Slaughterhouse-Five, Salt: A World History, Interpreter of Maladies, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), The Panther  (John Corey, #6), The Hobbit,
Nearest to The Maze Runner (Maze Runner, #1): The Body Finder (The Body Finder, #1), The 39 Steps (Richard Hannay, #1), Trojan Odyssey (Dirk Pitt, #17), Infinity (Chronicles of Nick, #1), Beautiful Darkness (Caster Chronicles, #2), The Ugly Truth (Diary of a Wimpy Kid, #5), The Black Circle (The 39 Clues, #5), Soulless (Parasol Protectorate, #1),
Average loss at step  42000 :  3.54164383775
Average loss at step  44000 :  3.61175434327
Average loss at step  46000 :  3.55967957151
Average loss at step  48000 :  3.49804186225
Average loss at step  50000 :  3.46732353914
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Midnight Sun (Twilight, #1.5), James and the Giant Peach, The Graveyard Book, The Sirens of Titan, The Prince of Tides, Purple Cow: Transform Your Business by Being Remarkable, The Mote in God's Eye, Lock and Key,
Nearest to Lord of the Flies: Crime and Punishment, 1984, The Great Gatsby, The Shining (The Shining #1), Zen and the Art of Motorcycle Maintenance: An Inquiry Into Values, The Quiet American, Memories of My Melancholy Whores, The Kite Runner,
Nearest to Bossypants: Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), State of Wonder, The Expats, Barbarians at the Gate: The Fall of RJR Nabisco, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, A Trick of the Light (Chief Inspector Armand Gamache, #7), Unfamiliar Fishes, The Paris Wife,
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), Chains (Seeds of America, #1), The Help, One Day, Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, Clockwork Angel (The Infernal Devices, #1), City of Glass (The Mortal Instruments, #3), Best Friends Forever,
Nearest to Jane Eyre: Les Misérables, The Lovely Bones, Eat, Pray, Love, Memoirs of a Geisha, The Subtle Knife (His Dark Materials, #2), To Kill a Mockingbird, Beloved, The Importance of Being Earnest,
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, Uglies (Uglies, #1), The Diary of a Young Girl, The Bookseller of Kabul, The Memory Keeper's Daughter, No Country for Old Men, Middlesex,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Life of Pi, Memoirs of a Geisha, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), Animal, Vegetable, Miracle: A Year of Food Life, The Children of Húrin, The Diary of a Young Girl, Catch-22,
Nearest to Atonement: Siddhartha, The Old Man and the Sea, To Kill a Mockingbird, Breakfast of Champions, Lord Loss (The Demonata, #1), Choke, Memoirs of a Geisha, The Secret Life of Bees,
Nearest to The Handmaid's Tale: The Mists of Avalon (Avalon, #1), White Noise, The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, The Portrait of a Lady, Three Cups of Tea: One Man's Mission to Promote Peace ... One School at a Time, Fight Club, No Country for Old Men, Notes from Underground, White Nights, The Dream of a Ridiculous Man, and Selections from The House of the Dead,
Nearest to Animal Farm: Haunted, Gone with the Wind, Killing Yourself to Live: 85% of a True Story, Ishmael:A Novel, The Crucible, The Book Thief, Artemis Fowl (Artemis Fowl, #1), Nineteen Minutes,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), Owl Moon, Lone Wolf, The Ship of Brides, Brain on Fire: My Month of Madness, The Twelve Tribes of Hattie, Seating Arrangements, The Golem and the Jinni (The Golem and the Jinni, #1),
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Ender's Game (Ender's Saga, #1), The Golden Compass (His Dark Materials, #1), Gates of Fire: An Epic Novel of the Battle of Thermopylae, A God in Ruins, Leven Thumps and the Eyes of the Want (Leven Thumps, #3), Zero to One: Notes on Startups, or How to Build the Future, Life of Pi,
Nearest to The Poisonwood Bible: The Plot Against America, The Kite Runner, The Color Purple, Cloud Atlas, Anil's Ghost, Mere Christianity, Jitterbug Perfume, The Historian,
Nearest to 1984: Slaughterhouse-Five, The God Delusion, Lord of the Flies, The Time Traveler's Wife, Lolita, Ender's Game (Ender's Saga, #1), Rosencrantz and Guildenstern Are Dead, A Clockwork Orange,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Slaughterhouse-Five, Interpreter of Maladies, Salt: A World History, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), The Panther  (John Corey, #6), Please Kill Me: The Uncensored Oral History of Punk,
Nearest to The Maze Runner (Maze Runner, #1): The Body Finder (The Body Finder, #1), The 39 Steps (Richard Hannay, #1), Trojan Odyssey (Dirk Pitt, #17), Infinity (Chronicles of Nick, #1), Beautiful Darkness (Caster Chronicles, #2), The Ugly Truth (Diary of a Wimpy Kid, #5), The Black Circle (The 39 Clues, #5), Matched (Matched, #1),
Average loss at step  52000 :  3.43458542252
Average loss at step  54000 :  3.4167132166
Average loss at step  56000 :  3.39902982748
Average loss at step  58000 :  3.47961636269
Average loss at step  60000 :  3.46612338716
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): Midnight Sun (Twilight, #1.5), James and the Giant Peach, The Graveyard Book, Lock and Key, The Professor, The Prince of Tides, The Sirens of Titan, Purple Cow: Transform Your Business by Being Remarkable,
Nearest to Lord of the Flies: 1984, Crime and Punishment, The Great Gatsby, Memories of My Melancholy Whores, The Kite Runner, The Quiet American, The Shining (The Shining #1), I Know Why the Caged Bird Sings,
Nearest to Bossypants: Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), Barbarians at the Gate: The Fall of RJR Nabisco, The Expats, State of Wonder, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, Unfamiliar Fishes, A Trick of the Light (Chief Inspector Armand Gamache, #7), The Paris Wife,
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), Chains (Seeds of America, #1), The Help, One Day, Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, City of Glass (The Mortal Instruments, #3), Best Friends Forever, Clockwork Angel (The Infernal Devices, #1),
Nearest to Jane Eyre: Les Misérables, The Lovely Bones, Memoirs of a Geisha, Eat, Pray, Love, The Subtle Knife (His Dark Materials, #2), To Kill a Mockingbird, Beloved, The Diary of a Young Girl,
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, The Diary of a Young Girl, Uglies (Uglies, #1), The Memory Keeper's Daughter, Middlesex, The Bookseller of Kabul, No Country for Old Men,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Life of Pi, Memoirs of a Geisha, The Children of Húrin, The Diary of a Young Girl, Catch-22, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), Animal, Vegetable, Miracle: A Year of Food Life,
Nearest to Atonement: Siddhartha, The Old Man and the Sea, To Kill a Mockingbird, Breakfast of Champions, Memoirs of a Geisha, The Secret Life of Bees, Lord Loss (The Demonata, #1), Choke,
Nearest to The Handmaid's Tale: The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, White Noise, The Mists of Avalon (Avalon, #1), Fight Club, The Portrait of a Lady, Dry, The Tin Drum, No Country for Old Men,
Nearest to Animal Farm: Haunted, Gone with the Wind, Ishmael:A Novel, The Crucible, Artemis Fowl (Artemis Fowl, #1), The Book Thief, Killing Yourself to Live: 85% of a True Story, Into Thin Air: A Personal Account of the Mount Everest Disaster,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), The Ship of Brides, Lone Wolf, Owl Moon, The Twelve Tribes of Hattie, Brain on Fire: My Month of Madness, Never Fade (The Darkest Minds, #2), Lexicon,
Nearest to Outlander (Outlander, #1): Ender's Game (Ender's Saga, #1), The Mermaid Chair, 1984, Life of Pi, Pilgrim at Tinker Creek, Gates of Fire: An Epic Novel of the Battle of Thermopylae, Reading Lolita in Tehran, The Golden Compass (His Dark Materials, #1),
Nearest to The Poisonwood Bible: The Kite Runner, The Plot Against America, Cloud Atlas, Anil's Ghost, Jitterbug Perfume, The Alchemist, The Color Purple, Mere Christianity,
Nearest to 1984: Slaughterhouse-Five, Lord of the Flies, The Time Traveler's Wife, The God Delusion, Lolita, Ender's Game (Ender's Saga, #1), A Clockwork Orange, Outlander (Outlander, #1),
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Slaughterhouse-Five, Salt: A World History, Interpreter of Maladies, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), The Panther  (John Corey, #6), Please Kill Me: The Uncensored Oral History of Punk,
Nearest to The Maze Runner (Maze Runner, #1): The Body Finder (The Body Finder, #1), The 39 Steps (Richard Hannay, #1), The Ugly Truth (Diary of a Wimpy Kid, #5), Beautiful Darkness (Caster Chronicles, #2), Infinity (Chronicles of Nick, #1), Trojan Odyssey (Dirk Pitt, #17), The Black Circle (The 39 Clues, #5), Torment (Fallen, #2),
Average loss at step  62000 :  3.39424202061
Average loss at step  64000 :  3.36651503634
Average loss at step  66000 :  3.33070478445
Average loss at step  68000 :  3.32326644897
Average loss at step  70000 :  3.31573734951
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): The Graveyard Book, Midnight Sun (Twilight, #1.5), James and the Giant Peach, Lock and Key, The Professor, The Sirens of Titan, Islands in the Stream, Purple Cow: Transform Your Business by Being Remarkable,
Nearest to Lord of the Flies: 1984, Crime and Punishment, The Great Gatsby, The Kite Runner, Memories of My Melancholy Whores, The Quiet American, Fahrenheit 451, The Time Traveler's Wife,
Nearest to Bossypants: Barbarians at the Gate: The Fall of RJR Nabisco, Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), The Expats, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, State of Wonder, Unfamiliar Fishes, The Bedwetter: Stories of Courage, Redemption, and Pee, A Trick of the Light (Chief Inspector Armand Gamache, #7),
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), The Help, City of Glass (The Mortal Instruments, #3), Chains (Seeds of America, #1), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, One Day, Best Friends Forever, Frostbite (Vampire Academy, #2),
Nearest to Jane Eyre: The Lovely Bones, Memoirs of a Geisha, Les Misérables, Eat, Pray, Love, To Kill a Mockingbird, Beloved, A Thousand Splendid Suns, The Subtle Knife (His Dark Materials, #2),
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, Uglies (Uglies, #1), The Memory Keeper's Daughter, The Diary of a Young Girl, The Bookseller of Kabul, Middlesex, The Perks of Being a Wallflower,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Life of Pi, Memoirs of a Geisha, The Children of Húrin, Catch-22, Me Talk Pretty One Day, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), The Diary of a Young Girl,
Nearest to Atonement: The Old Man and the Sea, Siddhartha, To Kill a Mockingbird, Breakfast of Champions, The Secret Life of Bees, Memoirs of a Geisha, Beloved, Lord Loss (The Demonata, #1),
Nearest to The Handmaid's Tale: The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, The Mists of Avalon (Avalon, #1), White Noise, Fight Club, The Tin Drum, The Book Thief, The Crying of Lot 49, Dry,
Nearest to Animal Farm: Haunted, Gone with the Wind, Ishmael:A Novel, The Book Thief, Civil Disobedience and Other Essays, Artemis Fowl (Artemis Fowl, #1), The Crucible, Killing Yourself to Live: 85% of a True Story,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), The Ship of Brides, The Twelve Tribes of Hattie, Lone Wolf, Owl Moon, Never Fade (The Darkest Minds, #2), The Golem and the Jinni (The Golem and the Jinni, #1), Lexicon,
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Ender's Game (Ender's Saga, #1), Pilgrim at Tinker Creek, 1984, Gates of Fire: An Epic Novel of the Battle of Thermopylae, Life of Pi, Cloud Atlas, Zero to One: Notes on Startups, or How to Build the Future,
Nearest to The Poisonwood Bible: The Kite Runner, Cloud Atlas, The Plot Against America, The Color Purple, Anil's Ghost, Jitterbug Perfume, The Alchemist, Mere Christianity,
Nearest to 1984: Lord of the Flies, Slaughterhouse-Five, The Time Traveler's Wife, The God Delusion, Ender's Game (Ender's Saga, #1), Lolita, The Hobbit, Sense and Sensibility,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Salt: A World History, Slaughterhouse-Five, Interpreter of Maladies, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), Please Kill Me: The Uncensored Oral History of Punk, The Panther  (John Corey, #6),
Nearest to The Maze Runner (Maze Runner, #1): The Ugly Truth (Diary of a Wimpy Kid, #5), The Body Finder (The Body Finder, #1), Beautiful Darkness (Caster Chronicles, #2), The 39 Steps (Richard Hannay, #1), Infinity (Chronicles of Nick, #1), The Black Circle (The 39 Clues, #5), I Don't Know How She Does It, Torment (Fallen, #2),
Average loss at step  72000 :  3.37959288603
Average loss at step  74000 :  3.4224101547
Average loss at step  76000 :  3.32037075186
Average loss at step  78000 :  3.29888544989
Average loss at step  80000 :  3.26403364515
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): James and the Giant Peach, Midnight Sun (Twilight, #1.5), The Graveyard Book, The Professor, Lock and Key, The Mote in God's Eye, The Sirens of Titan, The Prince of Tides,
Nearest to Lord of the Flies: 1984, The Great Gatsby, Crime and Punishment, Memories of My Melancholy Whores, The Kite Runner, Slaughterhouse-Five, Fahrenheit 451, The Shining (The Shining #1),
Nearest to Bossypants: Barbarians at the Gate: The Fall of RJR Nabisco, Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), The Expats, Pathfinder (Pathfinder, #1), Unfamiliar Fishes, State of Wonder, Save Me, The Bedwetter: Stories of Courage, Redemption, and Pee,
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), City of Glass (The Mortal Instruments, #3), The Help, Chains (Seeds of America, #1), Marked (House of Night, #1), Best Friends Forever, Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer, Frostbite (Vampire Academy, #2),
Nearest to Jane Eyre: The Lovely Bones, Memoirs of a Geisha, To Kill a Mockingbird, Les Misérables, Eat, Pray, Love, Beloved, The Diary of a Young Girl, A Thousand Splendid Suns,
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, Uglies (Uglies, #1), The Memory Keeper's Daughter, The Diary of a Young Girl, Middlesex, The Bookseller of Kabul, The Perks of Being a Wallflower,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Memoirs of a Geisha, Life of Pi, The Children of Húrin, Wicked: The Life and Times of the Wicked Witch of the West (The Wicked Years, #1), The Lovely Bones, The Diary of a Young Girl, Me Talk Pretty One Day,
Nearest to Atonement: To Kill a Mockingbird, The Old Man and the Sea, Siddhartha, The Secret Life of Bees, Breakfast of Champions, Choke, Memoirs of a Geisha, Beloved,
Nearest to The Handmaid's Tale: The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, The Mists of Avalon (Avalon, #1), The Tin Drum, Fight Club, White Noise, The Book Thief, The Crying of Lot 49, No Country for Old Men,
Nearest to Animal Farm: Haunted, Gone with the Wind, Ishmael:A Novel, Civil Disobedience and Other Essays, The Crucible, Artemis Fowl (Artemis Fowl, #1), Into Thin Air: A Personal Account of the Mount Everest Disaster, Killing Yourself to Live: 85% of a True Story,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), The Twelve Tribes of Hattie, The Ship of Brides, Lone Wolf, The Golem and the Jinni (The Golem and the Jinni, #1), Anna Karenina, Owl Moon, Seating Arrangements,
Nearest to Outlander (Outlander, #1): The Mermaid Chair, Pilgrim at Tinker Creek, Life of Pi, 1984, Gates of Fire: An Epic Novel of the Battle of Thermopylae, Ender's Game (Ender's Saga, #1), Extremely Loud and Incredibly Close, The Miniaturist,
Nearest to The Poisonwood Bible: The Plot Against America, The Kite Runner, Cloud Atlas, Anil's Ghost, The Color Purple, Jitterbug Perfume, Lolita, The Alchemist,
Nearest to 1984: Slaughterhouse-Five, Lord of the Flies, The Time Traveler's Wife, Life of Pi, The God Delusion, Lolita, Outlander (Outlander, #1), A Clockwork Orange,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Salt: A World History, Interpreter of Maladies, Slaughterhouse-Five, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), Please Kill Me: The Uncensored Oral History of Punk, So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), Night (The Night Trilogy #1),
Nearest to The Maze Runner (Maze Runner, #1): The Ugly Truth (Diary of a Wimpy Kid, #5), The Body Finder (The Body Finder, #1), Beautiful Darkness (Caster Chronicles, #2), Infinity (Chronicles of Nick, #1), I Don't Know How She Does It, The 39 Steps (Richard Hannay, #1), The Black Circle (The 39 Clues, #5), Torment (Fallen, #2),
Average loss at step  82000 :  3.25146297926
Average loss at step  84000 :  3.25321617091
Average loss at step  86000 :  3.29557959634
Average loss at step  88000 :  3.39157348788
Average loss at step  90000 :  3.27380904102
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): James and the Giant Peach, Midnight Sun (Twilight, #1.5), The Professor, The Graveyard Book, Lock and Key, Islands in the Stream, The Prince of Tides, Nefertiti,
Nearest to Lord of the Flies: 1984, The Great Gatsby, The Kite Runner, Crime and Punishment, Memories of My Melancholy Whores, Slaughterhouse-Five, The Time Traveler's Wife, Fahrenheit 451,
Nearest to Bossypants: Barbarians at the Gate: The Fall of RJR Nabisco, The Expats, Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), Unfamiliar Fishes, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin, Teacher Man (Frank McCourt, #3), The Paris Wife, Save Me,
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), City of Glass (The Mortal Instruments, #3), The Help, Chains (Seeds of America, #1), Marked (House of Night, #1), Best Friends Forever, Frostbite (Vampire Academy, #2), Twilight Director's Notebook : The Story of How We Made the Movie Based on the Novel by Stephenie Meyer,
Nearest to Jane Eyre: The Lovely Bones, Memoirs of a Geisha, To Kill a Mockingbird, Les Misérables, Eat, Pray, Love, Beloved, A Thousand Splendid Suns, The Diary of a Young Girl,
Nearest to The Lovely Bones: The Secret Life of Bees, Jane Eyre, The Memory Keeper's Daughter, Uglies (Uglies, #1), The Diary of a Young Girl, The Perks of Being a Wallflower, The Bookseller of Kabul, Middlesex,
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Memoirs of a Geisha, Life of Pi, The Children of Húrin, The Lovely Bones, Catch-22, The Diary of a Young Girl, Me Talk Pretty One Day,
Nearest to Atonement: To Kill a Mockingbird, The Old Man and the Sea, Siddhartha, The Secret Life of Bees, Breakfast of Champions, Memoirs of a Geisha, Beloved, Jane Eyre,
Nearest to The Handmaid's Tale: The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, The Book Thief, The Tin Drum, Fight Club, White Noise, The Mists of Avalon (Avalon, #1), The Crying of Lot 49, Winter's Tale,
Nearest to Animal Farm: Haunted, Gone with the Wind, The Book Thief, Ishmael:A Novel, The Fellowship of the Ring (The Lord of the Rings, #1), Into Thin Air: A Personal Account of the Mount Everest Disaster, Artemis Fowl (Artemis Fowl, #1), Les Misérables,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), The Ship of Brides, The Twelve Tribes of Hattie, Lone Wolf, Never Fade (The Darkest Minds, #2), The Golem and the Jinni (The Golem and the Jinni, #1), Anna Karenina, Lexicon,
Nearest to Outlander (Outlander, #1): 1984, Pilgrim at Tinker Creek, The Mermaid Chair, Life of Pi, Ender's Game (Ender's Saga, #1), Gates of Fire: An Epic Novel of the Battle of Thermopylae, The Namesake, Extremely Loud and Incredibly Close,
Nearest to The Poisonwood Bible: The Kite Runner, The Plot Against America, Cloud Atlas, Anil's Ghost, Lolita, The Alchemist, Jitterbug Perfume, The Color Purple,
Nearest to 1984: Lord of the Flies, Slaughterhouse-Five, Lolita, The Time Traveler's Wife, Outlander (Outlander, #1), Life of Pi, A Clockwork Orange, Ender's Game (Ender's Saga, #1),
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Salt: A World History, Interpreter of Maladies, Slaughterhouse-Five, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), Please Kill Me: The Uncensored Oral History of Punk, Night (The Night Trilogy #1),
Nearest to The Maze Runner (Maze Runner, #1): The Ugly Truth (Diary of a Wimpy Kid, #5), Beautiful Darkness (Caster Chronicles, #2), The Body Finder (The Body Finder, #1), Infinity (Chronicles of Nick, #1), I Don't Know How She Does It, The 39 Steps (Richard Hannay, #1), The Black Circle (The 39 Clues, #5), Torment (Fallen, #2),
Average loss at step  92000 :  3.245428859
Average loss at step  94000 :  3.21859055138
Average loss at step  96000 :  3.20974324721
Average loss at step  98000 :  3.19917794842
Average loss at step  100000 :  3.22653954786
Nearest to The Girl with the Dragon Tattoo (Millennium, #1): James and the Giant Peach, Midnight Sun (Twilight, #1.5), The Graveyard Book, The Professor, Lock and Key, The Sirens of Titan, Purple Cow: Transform Your Business by Being Remarkable, Inkdeath (Inkworld, #3),
Nearest to Lord of the Flies: 1984, The Great Gatsby, The Kite Runner, Crime and Punishment, Memories of My Melancholy Whores, Fahrenheit 451, Slaughterhouse-Five, The Time Traveler's Wife,
Nearest to Bossypants: Barbarians at the Gate: The Fall of RJR Nabisco, Pathfinder (Pathfinder, #1), The Expats, Miss Peregrine’s Home for Peculiar Children (Miss Peregrine’s Peculiar Children, #1), Unfamiliar Fishes, Teacher Man (Frank McCourt, #3), Save Me, In the Garden of Beasts: Love, Terror, and an American Family in Hitler's Berlin,
Nearest to City of Bones (The Mortal Instruments, #1): Graceling (Graceling Realm, #1), City of Glass (The Mortal Instruments, #3), Marked (House of Night, #1), The Help, Best Friends Forever, Chains (Seeds of America, #1), Frostbite (Vampire Academy, #2), Pride and Prejudice and Zombies (Pride and Prejudice and Zombies, #1),
Nearest to Jane Eyre: Memoirs of a Geisha, The Lovely Bones, Beloved, To Kill a Mockingbird, Eat, Pray, Love, A Thousand Splendid Suns, Les Misérables, The Diary of a Young Girl,
Nearest to The Lovely Bones: The Memory Keeper's Daughter, The Secret Life of Bees, Jane Eyre, Uglies (Uglies, #1), The Diary of a Young Girl, The Perks of Being a Wallflower, The Bookseller of Kabul, The Giver (The Giver, #1),
Nearest to The Giver (The Giver, #1): The Old Man and the Sea, Memoirs of a Geisha, Life of Pi, Catch-22, The Children of Húrin, The Lovely Bones, The Diary of a Young Girl, Me Talk Pretty One Day,
Nearest to Atonement: The Old Man and the Sea, To Kill a Mockingbird, Siddhartha, The Secret Life of Bees, Breakfast of Champions, Beloved, Memoirs of a Geisha, Choke,
Nearest to The Handmaid's Tale: The Hot Zone: The Terrifying True Story of the Origins of the Ebola Virus, The Tin Drum, Fight Club, Winter's Tale, The Book Thief, White Noise, Running with Scissors, The Mists of Avalon (Avalon, #1),
Nearest to Animal Farm: Haunted, Gone with the Wind, Ishmael:A Novel, Civil Disobedience and Other Essays, Artemis Fowl (Artemis Fowl, #1), Les Misérables, The Fellowship of the Ring (The Lord of the Rings, #1), Into Thin Air: A Personal Account of the Mount Everest Disaster,
Nearest to The Ocean at the End of the Lane: The Runaway King (The Ascendance Trilogy, #2), The Twelve Tribes of Hattie, Lone Wolf, Never Fade (The Darkest Minds, #2), The Ship of Brides, Anna Karenina, The Golem and the Jinni (The Golem and the Jinni, #1), Promise of Blood (Powder Mage, #1),
Nearest to Outlander (Outlander, #1): 1984, Pilgrim at Tinker Creek, The Mermaid Chair, Ender's Game (Ender's Saga, #1), The Namesake, Life of Pi, Gates of Fire: An Epic Novel of the Battle of Thermopylae, Cloud Atlas,
Nearest to The Poisonwood Bible: The Kite Runner, Cloud Atlas, The Plot Against America, Anil's Ghost, The Omnivore's Dilemma: A Natural History of Four Meals, The Color Purple, The Alchemist, Lolita,
Nearest to 1984: Lord of the Flies, Slaughterhouse-Five, The Time Traveler's Wife, Outlander (Outlander, #1), Ender's Game (Ender's Saga, #1), Lolita, A Clockwork Orange, Life of Pi,
Nearest to The Devil in the White City: Murder, Magic, and Madness at the Fair That Changed America: The Joke, Salt: A World History, Interpreter of Maladies, Slaughterhouse-Five, The Hammer of Thor (Magnus Chase and the Gods of Asgard, #2), So Long, and Thanks for All the Fish (Hitchhiker's Guide to the Galaxy, #4), Night (The Night Trilogy #1), Please Kill Me: The Uncensored Oral History of Punk,
Nearest to The Maze Runner (Maze Runner, #1): The Ugly Truth (Diary of a Wimpy Kid, #5), Beautiful Darkness (Caster Chronicles, #2), I Don't Know How She Does It, The Body Finder (The Body Finder, #1), Infinity (Chronicles of Nick, #1), The 39 Steps (Richard Hannay, #1), Torment (Fallen, #2), The Black Circle (The 39 Clues, #5),
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">final_embeddings</span><span class="o">.</span><span class="n">shape</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>(9951, 128)
</code></pre>
</div>


		</div>
		<div class="tutorial-share">
			<a class="modalOpen no-smooth" href="#subscribe">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
		
 Subscribe</a>
			<a class="modalOpen no-smooth" href="#share">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
				<path d="M0 0h24v24H0z" fill="none"/>
				<path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
			</svg>
		
 Share</a>
		</div>
	</section>
</section>





	<div class="related">
		<h3>Related tutorials</h3>

		<ul class="listing">
	
		<li >
			<a href="/machine-learning/Numeric-feature-engineering/">
				<div class="icon"></div>
				<article>
					<div>
						<h3>Feature Engineering on Numeric features</h3>
						<p class="description">Feature Preprocessing and generation with respect to models</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/machine-learning/Missing-data-imputation/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Feature Engineering Part II -- Missing Values</h3>
						<p class="description">Feature Preprocessing and generation with respect to models. Approaches to fill NA</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/machine-learning/Categorical-feature-engineering/">
				<div class="icon"></div>
				<article>
					<div>
						<h3>Feature Engineering on Categorical and Ordinal features"</h3>
						<p class="description">Feature Preprocessing and generation with respect to models</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/top%204%25%20kaggle%20solution/PCA/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>PCA can do more than dimension reduction</h3>
						<p class="description">Apply pca on generated features</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/top%204%25%20kaggle%20solution/Model-Training/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Stacking in Machine Learning</h3>
						<p class="description">How weak regressors beat builky ones</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/top%204%25%20kaggle%20solution/EDA/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>From Exploratory Analysis to Feature Engineering</h3>
						<p class="description">Generated hundres of features based on exploratory data analysis</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/machine-learning/bag-of-words/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Bag of words</h3>
						<p class="description">Feature Extraction I -- Bag of words</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/recommender/Deep-Learning/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Deep Neural Networds</h3>
						<p class="description">Recommendation System Algorithms II -- Deep Learning</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/recommender/Collaborative-Filtering/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Collaborative Filtering</h3>
						<p class="description">Recommendation System Algorithms I -- Collaborative Filtering</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/machine-learning/machine-learning-recap/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Machine Learning Recap</h3>
						<p class="description">Top 4 families of machine learning algorithms -- Linear Model, Tree-based methods, k-Nearest Neighbors and Neural Nets</p>
					</div>
				</article>
			</a>
		</li>
	
</ul>
	</div>



	<div id="disqus_thread"></div>
	<script>
		var disqus_shortname = 'greendata-1';
		var disqus_config = function () {
			this.page.url = "https://orange-ape.cloudvent.net//recommender/Word2Vec/";
			this.page.identifier = "/recommender/Word2Vec";
		};
		(function() {  // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');
			s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


<div id="subscribe" class="modalDialog">
	<div>
		<a title="Close" class="close">&times;</a>
		<form action="" method="post">
			<h2>Subscribe</h2>
			<p>The latest tutorials sent straight to your inbox.</p>
			<input type="email" name="EMAIL" placeholder="Email">
			<input type="submit" value="Sign up">
		</form>
	</div>
</div>

<div id="share" class="modalDialog sharing">
	<div>
		<a title="Close" class="close">&times;</a>
		<h2>Share</h2>
		<p>Share this tutorial with your community.</p>
		<ul>
			<li><a class="twitter" target="_blank" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Forange-ape.cloudvent.net%2F%2Frecommender%2FWord2Vec%2F">
		<svg class="twitter" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	
 Twitter</a></li>
			<li><a class="facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Forange-ape.cloudvent.net%2F%2Frecommender%2FWord2Vec%2F">
		<svg class="facebook" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="15.8 15.8 25 25"><path d="M32.8 24.7h-3.2v-2.1c0-0.8 0.5-1 0.9-1s2.3 0 2.3 0v-3.5l-3.1 0c-3.5 0-4.3 2.6-4.3 4.3v2.3h-2v3.6h2c0 4.6 0 10.2 0 10.2h4.2c0 0 0-5.6 0-10.2h2.8L32.8 24.7z"/></svg>
	
 Facebook</a></li>
			<li><a class="google-plus" target="_blank" href="https://plus.google.com/share?url=https%3A%2F%2Forange-ape.cloudvent.net%2F%2Frecommender%2FWord2Vec%2F">
		<svg class="google-plus" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z" /></svg>
	
 Google+</a></li>
			<li><a class="hacker-news" target="_blank" href="http://news.ycombinator.com/submitlink?u=https%3A%2F%2Forange-ape.cloudvent.net%2F%2Frecommender%2FWord2Vec%2F&t=From%20Word2Vec%20to%20Item%20Recommendation">
		<svg class="hacker-news" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18.8 3.3c-0.4 0.8-5.6 11.1-5.6 11.2 0 2 0 6.2 0 6.2 -0.1 0-2.2 0-2.3 0 0 0 0-5.9 0-6.2 0 0-5.5-10.9-5.6-11.1C5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3c0 0 0 0 0.1 0 0.9 0 1.7 0 2.6 0 0 0 0 0 0 0.1 0.1 0.1 4 8.3 4.1 8.3 0 0 4.2-8.3 4.3-8.4 0.8 0 1.6 0 2.4 0 0 0 0 0 0 0C18.8 3.3 18.8 3.3 18.8 3.3z"/></svg>
	
 Hacker News</a></li>
		</ul>
	</div>
</div>

<script src="/js/main.js"></script>

<script>
	var headings = document.querySelectorAll("h2[id]");

	console.log(headings);
	for (var i = 0; i < headings.length; i++) {
		var anchorLink = document.createElement("a");
		anchorLink.innerText = "#";
		anchorLink.href = "#" + headings[i].id;
		anchorLink.classList.add("header-link");

		headings[i].appendChild(anchorLink);
	}

	$(".modalOpen").click(function() {
		var id = $(this).attr("href");
		$(id).addClass("show");

		$(window).click(function() {
			$(".show").removeClass("show");
		});

		$(id + " > div").click(function(event){
			event.stopPropagation();
		});
		return false;
	});

	$(".close").click(function() {
		$(".show").removeClass("show");
		return false;
	});

	$(document).keyup(function(e) {
		if (e.keyCode == 27) {
			$(".show").removeClass("show");
		}
	});
</script>

			</div>
		</section>

		<footer>
	<div class="wrapper">
		<p class="edit-footer"><a class="editor-link btn" href="cloudcannon:collections/_data/footer.yml" class="btn" style="padding: 5px;"><strong>&#9998;</strong> Edit footer</a></p>
		<ul class="footer-links">
			
				<li><a target="_blank" href="https://facebook.com/" class="Facebook-icon">
					
						
		<svg class="facebook" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M19,4V7H17A1,1 0 0,0 16,8V10H19V13H16V20H13V13H11V10H13V7.5C13,5.56 14.57,4 16.5,4M20,2H4A2,2 0 0,0 2,4V20A2,2 0 0,0 4,22H20A2,2 0 0,0 22,20V4C22,2.89 21.1,2 20,2Z" /></svg>
	

					
					</a></li>
			
				<li><a target="_blank" href="https://twitter.com/" class="Twitter-icon">
					
						
		<svg class="twitter" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg>
	

					
					</a></li>
			
				<li><a target="_blank" href="https://youtube.com/" class="YouTube-icon">
					
						
		<svg class="youtube" fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M10,16.5V7.5L16,12M20,4.4C19.4,4.2 15.7,4 12,4C8.3,4 4.6,4.19 4,4.38C2.44,4.9 2,8.4 2,12C2,15.59 2.44,19.1 4,19.61C4.6,19.81 8.3,20 12,20C15.7,20 19.4,19.81 20,19.61C21.56,19.1 22,15.59 22,12C22,8.4 21.56,4.91 20,4.4Z" /></svg>
	

					
					</a></li>
			
				<li><a  href="/feed.xml" class="RSS-icon">
					
						
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
		

					
					</a></li>
			
		</ul>
		<p class="copyright">&copy; Base 2018. All rights reserved.</p>
	</div>
</footer>
		<script>
			$(function() {
				$('a[href*=\\#]').not(".no-smooth").on('click', function(event){
					var el = $(this.hash);
					if (el.length > 0) {
						// event.preventDefault();
						$('html,body').animate({scrollTop:$(this.hash).offset().top - 50}, 500);
					}
				});

				$('svg').click(function() {
					$(this).parent('form').submit();
				});
			});

			document.getElementById("open-nav").addEventListener("click", function (event) {
				event.preventDefault();
				document.body.classList.toggle("nav-open");
			});
		</script>
		
	</body>
</html>
